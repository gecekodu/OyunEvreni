git // ğŸ” FIRESTORE SECURITY RULES
// Firebase Console: Firestore Database â†’ Rules kÄ±smÄ±na kopyala
// TÃ¼m kullanÄ±cÄ±larÄ± korur, aynÄ± anda binlerce puan iÅŸlemini gÃ¼venle yÃ¶netir

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // âœ… USERS KOLEKSÄ°YONU
    // Her kullanÄ±cÄ± kendi profilini yazabilir
    // Herkes leaderboard'u okuyabilir
    match /users/{userId} {
      allow read: if true;  // Leaderboard gÃ¶rmek iÃ§in herkese aÃ§Ä±k
      allow write: if request.auth != null && request.auth.uid == userId;
      allow update: if request.auth != null && request.auth.uid == userId;
      allow delete: if request.auth != null && request.auth.uid == userId;
    }

    // âœ… SCORES KOLEKSÄ°YONU
    // Oyun skorlarÄ±nÄ± tutuyor
    match /scores/{scoreId} {
      allow read: if true;  // Herkes skorlarÄ± gÃ¶rebilir
      allow create: if request.auth != null;  // GiriÅŸ yapmÄ±ÅŸsa skor kaydedebilir
      allow update: if request.auth != null && resource.data.userId == request.auth.uid;
      allow delete: if request.auth != null && resource.data.userId == request.auth.uid;
    }

    // âœ… GAMES KOLEKSÄ°YONU
    // Oyun tanÄ±mlarÄ±nÄ± tutuyor
    match /games/{gameId} {
      allow read: if true;  // Herkes oyunlarÄ± gÃ¶rebilir
      allow write: if request.auth != null;  // Admin kontrol edilmeli
    }

    // âœ… LEADERBOARD KOLEKSÄ°YONU (Genel SÄ±ralama)
    match /leaderboard/{document=**} {
      allow read: if true;  // Herkese leaderboard okuma izni
      allow write: if request.auth != null;  // Authenticated kullanÄ±cÄ±lar yazabilir
    }

    // âœ… USER SESSIONS (isteÄŸe baÄŸlÄ± - Ã¶ÄŸrenme verisi)
    match /user_sessions/{sessionId} {
      allow read: if request.auth != null && resource.data.userId == request.auth.uid;
      allow create: if request.auth != null;
      allow update: if request.auth != null && resource.data.userId == request.auth.uid;
      allow delete: if request.auth != null && resource.data.userId == request.auth.uid;
    }

    // âš ï¸ HILE KORUMA
    // Atomic Increment kullanÄ±ldÄ±ÄŸÄ±ndan birÃ§ok eÅŸzamanlÄ± yazma iÅŸlemi gÃ¼venle yÃ¶netilir
    // Firebase Rules sadece eriÅŸim kontrolÃ¼ yapar; veri tutarlÄ±lÄ±ÄŸÄ± Firestore tarafÄ±ndan garantilenir
  }
}

/*
ğŸ“‹ KÃœÃ‡ UK Ä°PUCLARI:

1ï¸âƒ£ TOPLAM PUAN GÃœNCELLEMESÄ°
   âœ… AdÄ±m: HTML oyun puan gÃ¶nderir â†’ Flutter handle eder â†’ Atomic increment yapar
   
2ï¸âƒ£ LEADERBOARD SORGULAMA
   âœ… Firestore otomatikman toplam puanÄ±n yÃ¼ksekten dÃ¼ÅŸÃ¼ÄŸe sÄ±ralanmÄ±ÅŸ index kullanÄ±r
   
3ï¸âƒ£ HILE RÄ°SKÄ°
   âŒ MÃ¼ÅŸteri tarafÄ± puan deÄŸiÅŸtirilebilir ANCAK:
      â€¢ Firebase Authentication zorunlu
      â€¢ Rules sadece kendi UID'nize yazmanÄ±za izin verir
      â€¢ Server timestamp otomatikman toplanÄ±r
      
4ï¸âƒ£ Ã–LÃ‡EKLENME
   âœ… Atomic increment tÃ¼merinde Ã§akÄ±ÅŸmalarÄ± Ã¶nler
   âœ… Firestore saniyede milyonlarca iÅŸlemi yÃ¶netebilir

5ï¸âƒ£ GELECEK (ADVANCEd)
   â€¢ Firebase Functions ile puan validasyonu
   â€¢ Client tarafÄ± ÅŸifreli imza
   â€¢ Bot algÄ±lama sistemi
*/
